import{aQ as ve,j as e,B as u,cc as K,T as g,bx as se,D as ye,r,cd as te,t as s,b$ as Ce,b as re,bo as ne,H as oe,be as D,X as H,c as je,Y as Te,ce as we,d as B,o as P,ac as Ne,e as O,cf as W,g as S,$ as ke,i as Ae,a1 as V,l as le,aX as Re,aY as Se,aZ as ee,_ as X,x as Ie,b0 as Ee,b1 as _e,K as $e,v as Oe,Z as De,q as Q,O as A}from"./assets/index-BDcs8OaA.js";import{F as He}from"./2i83e0Nu.js";import{I as ie}from"./nlzjmGkJ.js";import{C as ae}from"./y5ax0GID.js";import{P as Le}from"./gLsK49VX.js";import{V as Me}from"./bwNrJKc_.js";import{u as ze}from"./PQMoyBaT.js";import{a as ce}from"./g03_-ZTT.js";import"./dPAOcghz.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[t]="2b5154cd-1ef5-4062-9df7-77016aa31d5f",a._sentryDebugIdIdentifier="sentry-dbid-2b5154cd-1ef5-4062-9df7-77016aa31d5f")}catch{}})();const Fe=ve.map(a=>({value:a,Component:e.jsxs(u,{alignCenter:!0,className:"gap-x-2",children:[e.jsx(K,{withoutBackground:!0,chain:a,size:24}),e.jsx(g,{children:se(a)})]})})),Ve=({chain:a,onChange:t})=>e.jsx(ye,{buttonClassName:"w-[120px]",menuItems:Fe,onChange:t,openComponent:e.jsxs(u,{alignCenter:!0,className:"gap-x-2",children:[e.jsx(K,{withoutBackground:!0,chain:a,size:24}),e.jsx(g,{children:se(a)})]}),value:a}),Be=r.memo(({editThorname:a})=>{const t=ze(),{data:o}=te();return t?.length?e.jsxs(u,{col:!0,className:"pt-8 w-full",children:[e.jsx(g,{className:"pb-4",textStyle:"h5",children:s("views.thorname.myThornames")}),e.jsx(Ce,{secondary:!0,maxHeight:"60vh",scrollClassName:"!mr-2",children:t.map(({thorname:h,expire:i,entries:d=[],owner:p})=>e.jsx(re,{className:"!p-0 m-2",children:e.jsx(ne,{className:"!py-1",shadow:!1,title:e.jsxs(u,{alignCenter:!0,row:!0,className:"gap-2",flex:1,justify:"between",children:[e.jsx(g,{children:h}),e.jsx(oe,{iconName:"edit",onClick:()=>a(h),size:16})]}),children:e.jsx(ie,{items:[{label:s("views.thorname.expire"),value:e.jsxs(u,{center:!0,className:"gap-x-2",children:[e.jsx(D,{content:s("views.thorname.expirationNote",{block:i}),iconName:"infoCircle"}),e.jsx(g,{children:ce({expire:i||"0",lastThorchainBlock:o?.[0]?.thorchain})})]})},{label:s("views.thorname.owner"),value:p},...d.map(({address:n,chain:C})=>({label:e.jsx(K,{withoutBackground:!0,chain:C,size:24}),value:H(n,15)}))]})})},`${h}-${p}-${i}`))})]}):null}),Pe=a=>({handleCopyValue:r.useCallback(()=>{je(a),Te(s("common.copied"))},[a])}),We=({type:a="icon",value:t})=>{const{handleCopyValue:o}=Pe(t);return a==="icon"?e.jsx(oe,{iconName:"copy",onClick:o,size:16,tooltip:s("common.copy")}):e.jsx(D,{content:s("common.copy"),children:e.jsx(u,{onClick:o,children:e.jsx(g,{className:we,fontWeight:"semibold",textStyle:"caption",children:t})})})},Ke=({thorname:a,details:t,available:o,years:h,setYears:i})=>{const{data:d}=te(),p=!t||o,n=r.useMemo(()=>[!t&&{label:s("components.sidebar.thorname"),value:e.jsxs("div",{className:"flex",children:[a," ",e.jsx(We,{type:"icon",value:a})]})},{label:s("views.thorname.status"),value:e.jsx(g,{variant:p?"green":"red",children:s(`views.thorname.${p?t?"ownedByYou":"available":"unavailable"}`)})},...p?[{label:t?s("views.thorname.extend"):s("views.thorname.duration"),value:e.jsxs(u,{alignCenter:!0,className:"gap-x-2",justify:"between",children:[e.jsx(B,{className:"px-1.5 group",leftIcon:e.jsx(P,{className:"group-hover:!text-light-typo-primary dark:group-hover:!text-dark-typo-primary",color:"secondary",name:"minusCircle"}),onClick:()=>i(h-1),variant:"borderlessTint"}),e.jsx(u,{center:!0,className:"w-3",children:e.jsx(g,{children:h})}),e.jsx(B,{className:"px-1.5 group",leftIcon:e.jsx(P,{className:"group-hover:!text-light-typo-primary dark:group-hover:!text-dark-typo-primary",color:"secondary",name:"plusCircle"}),onClick:()=>i(h+1),variant:"borderlessTint"})]})},{label:t?s("views.thorname.updateFee"):s("views.thorname.registrationFee"),value:e.jsxs(u,{center:!0,className:"gap-x-2",children:[e.jsx(Ne,{asset:O,size:"tiny"}),e.jsxs(g,{children:[t?h:W(h)," $THUNDER"]})]})}]:[]],[t,p,i,a,h]),C=r.useMemo(()=>t?[{label:s("views.thorname.expire"),value:e.jsxs(u,{center:!0,className:"gap-x-2",children:[e.jsx(D,{content:s("views.thorname.expirationNote",{block:t.expire}),iconName:"infoCircle"}),e.jsx(g,{children:ce({expire:t.expire,lastThorchainBlock:d?.[0]?.thorchain})})]})},{label:s("views.thorname.owner"),value:H(t.owner,15)}]:[],[t,d]),j=r.useMemo(()=>[...n,...C,...t?t.entries.map(({address:x,chain:T})=>({key:T,label:e.jsx(D,{content:`${a}.${T}`,children:e.jsx(K,{withoutBackground:!0,chain:T,size:24})}),value:H(x,15)})):[]].filter(Boolean),[n,t,C,a]);return{ownerColumns:C,data:t||o?j:[]}};function Ue(a){const t=r.useRef();return r.useEffect(()=>{t.current=a}),t.current}const ue={available:!1,chain:S.THUNDERChain,details:null,loading:!1,searchedThorname:"",currentThorname:"",years:1},Ye=(a,{type:t,payload:o})=>{switch(t){case"setLoading":return{...a,loading:o};case"setChain":return{...a,chain:o};case"setAvailable":return{...a,loading:!1,available:o};case"setSearchedThorname":{const h=o.length>=1;return{...h?a:ue,searchedThorname:h?le(o)?o.toLowerCase():a.searchedThorname:""}}case"setCurrentThorname":return{...a,currentThorname:o};case"setDetails":return{...a,details:o.details,available:o.available,loading:!1,years:o.details?0:1};case"setYears":return{...a,years:Math.min(Math.max(a.details?0:1,o),99)};default:return a}},qe=a=>{const t=ke(),o=Ue(a),[{available:h,chain:i,details:d,loading:p,searchedThorname:n,currentThorname:C,years:j},x]=r.useReducer(Ye,ue),[T]=Ae(),R=r.useCallback(b=>{x({type:"setChain",payload:b})},[]),I=r.useCallback(b=>{x({type:"setSearchedThorname",payload:b})},[]),U=r.useCallback(b=>{x({type:"setCurrentThorname",payload:b})},[]),f=r.useCallback(b=>{x({type:"setYears",payload:b})},[]),m=r.useCallback(async b=>{const{data:l}=await T(b||n),v=Array.isArray(l)||!l||typeof l=="boolean"?{details:null,available:!0}:{details:l,available:a?l.owner===a:!1};x({type:"setDetails",payload:v})},[T,a,n]),y=r.useCallback(async b=>{try{return x({type:"setLoading",payload:!0}),m(b),!0}catch(l){console.error(l);const v=l?.response?.status===404;return x({type:"setAvailable",payload:v}),v||V(s("common.defaultErrMsg")),!1}},[m]),N=r.useCallback(async(b,l)=>{if(!le(n))return V(s("notification.invalidTHUNDERName"));const v=!!l,w=d?.owner!==a;x({type:"setLoading",payload:!0});const L=w?W(j):j;let E=`${w?s("txManager.registerThorname"):s("txManager.updateThorname")} ${n} - ${L} ${O.ticker}`;d?.owner&&v&&(E=`${s("common.transfer")} ${n} - ${H(l,6,8)}`);const _=Re();t(Se({id:_,inChain:S.THUNDERChain,type:v?ee.TC_TNS_UPDATE:ee.TC_TNS_CREATE,label:E}));const $=v?{address:l,owner:l||a,name:n,chain:S.THUNDERChain}:{address:b,owner:a,name:n,chain:i},{registerThorname:Y}=await(await X(()=>import("./G7qcxkrX.js"),__vite__mapDeps([0,1,2]))).getSwapKitClient();try{const k=await Y({assetValue:Ie.fromChainOrSignature(S.THUNDERChain,L),...$});k&&t(Ee({id:_,txid:k}))}catch(k){console.error(k),t(_e({id:_,status:"error"})),V(s("notification.submitFail"))}finally{x({type:"setLoading",payload:!1}),setTimeout(m,5e3)}},[n,d?.owner,a,j,t,i,m]);return r.useEffect(()=>{n&&a!==o&&y()},[a]),{available:h,chain:i,details:d,loading:p,searchedThorname:n,currentThorname:C,years:j,lookupForTNS:y,registerThornameAddress:N,setChain:R,setSearchedThorname:I,setCurrentThorname:U,setYears:f}},Qe=()=>{const{setIsConnectModalOpen:a}=$e(),{isWalletLoading:t,getWalletAddress:o}=Oe(),{signingRequired:h}=De(),i=o(S.THUNDERChain),{available:d,chain:p,details:n,loading:C,registerThornameAddress:j,lookupForTNS:x,setChain:T,setSearchedThorname:R,setCurrentThorname:I,setYears:U,currentThorname:f,searchedThorname:m,years:y}=qe(i),[N,b]=r.useState(!1),[l,v]=r.useState(null),[w,L]=r.useState(""),[G,E]=r.useState(!1),[_,$]=r.useState(!1),[Y,k]=r.useState(0),M=o(p),de=r.useMemo(()=>h([O]),[h]),{data:he}=Ke({years:y,setYears:U,thorname:m,details:n,available:d}),z=r.useMemo(()=>n&&n?.owner!==i,[n,i]),q=r.useMemo(()=>(f.length===0||z||!!l&&!N)&&(f===m||f.length===0),[l,f,m,z,N]),Z=r.useMemo(()=>n?n?.entries.map(c=>c.chain):[],[n]),F=r.useCallback(()=>{if(!q){if(R(f),!(n||d)||f!==m)return k(1),x(f);i&&l&&N?j(l):a(!0)}},[q,R,f,m,n,d,k,x,i,l,N,j,a]),J=r.useCallback(()=>{F()},[F]),me=r.useCallback(c=>{c.key==="Enter"&&F()},[F]),pe=r.useCallback(c=>T(c),[T]),xe=r.useCallback(c=>{I(c),R(c),x(c)},[x,R,I]),fe=r.useMemo(()=>f!==m&&m!==""?s("common.refresh"):z?s("views.thorname.unavailableForPurchase"):d?i?Z.length>0?s("common.update"):s("views.thorname.purchase"):s("common.connectWallet"):s("views.wallet.search"),[z,d,i,Z.length,f,m]),be=r.useCallback(async()=>{const{validateAddress:c}=await(await X(()=>import("./G7qcxkrX.js"),__vite__mapDeps([0,1,2]))).getSwapKitClient();if(!c({chain:S.THUNDERChain,address:w||""}))return V(s("views.thorname.invalidTransferAddress"),s("views.thorname.inputValidThorAddress"));$(!0)},[w]);r.useEffect(()=>{M?v(M):M===void 0&&v("")},[M,p]),r.useEffect(()=>{l&&X(()=>import("./G7qcxkrX.js"),__vite__mapDeps([0,1,2])).then(({getSwapKitClient:c})=>c()).then(({validateAddress:c})=>b(!!c({chain:p,address:l})))},[l,p]);const ge=()=>{R(""),I(""),k(0)};return e.jsxs(Le,{description:s("views.thorname.description"),header:e.jsxs(u,{col:!0,children:[e.jsx(Me,{title:s("components.sidebar.thorname")}),e.jsxs(u,{className:"px-2.5 pt-1",justify:"between",children:[e.jsx(g,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:s("views.thorname.thornameSubtitle")}),e.jsx(D,{content:s("views.thorname.thornameInfo"),place:"bottom",children:e.jsx(P,{color:"primaryBtn",name:"infoCircle",size:24})})]})]}),keywords:"THUNDERName, THUNDERSwap, THUNDERChain, DEFI, DEX",title:s("views.thorname.title"),children:[e.jsx(Q,{autoFocus:!0,stretch:!0,border:"rounded",className:"!text-md p-1.5 flex-1 border",containerClassName:"bg-light-gray-light dark:bg-dark-gray-light !bg-opacity-80",onChange:c=>I(c.target.value),onKeyDown:me,placeholder:s("views.thorname.checkNameAvailability"),suffix:f&&e.jsx(P,{color:"secondary",name:"close",onClick:ge}),value:f}),d&&n&&e.jsx(re,{className:"!mt-2 !p-0 w-full",children:e.jsx(ne,{className:"!py-1",shadow:!1,title:e.jsxs(u,{className:"flex justify-between w-full",children:[e.jsx(g,{fontWeight:"medium",variant:"secondary",children:s("components.sidebar.thorname")}),e.jsx(g,{className:"text-right",fontWeight:"semibold",variant:"primary",children:m})]}),children:e.jsxs(u,{col:!0,className:"gap-4",children:[e.jsxs(u,{col:!0,children:[e.jsx(He,{label:s("views.thorname.transferTHUNDERName")}),e.jsx(u,{row:!0,className:"w-full gap-x-4",children:e.jsx(Q,{autoFocus:!0,stretch:!0,border:"rounded",className:"!text-md !p-1.5 border pt-5",containerClassName:"bg-light-gray-light dark:bg-dark-gray-light !bg-opacity-80",onChange:({target:c})=>L(c.value),placeholder:`${S.THUNDERChain} ${s("common.address")}`,value:w||""})})]}),e.jsx(B,{stretch:!0,disabled:!w,error:!!n&&d&&!N,loading:t||C,onClick:be,size:"sm",variant:"secondary",children:s("common.transfer")})]})})}),e.jsx(ie,{horizontalInset:!0,items:he,size:"lg"}),d&&n?.owner===i&&e.jsxs(u,{row:!0,className:"w-full pt-4",children:[e.jsx(Ve,{chain:p,onChange:pe}),e.jsx(Q,{autoFocus:!0,stretch:!0,border:"rounded",className:"!text-md !p-1.5 border",containerClassName:"bg-light-gray-light dark:bg-dark-gray-light !bg-opacity-80",onChange:({target:c})=>v(c.value),placeholder:`${p} ${s("common.address")}`,value:l||""})]}),e.jsx(u,{className:"w-full pt-6",children:e.jsx(B,{stretch:!0,disabled:q,error:!!n&&d&&!N,loading:t||C,onClick:()=>{Y===1&&i&&de&&m===f?E(!0):J()},size:"lg",variant:"fancy",children:fe})}),!n&&e.jsx(Be,{editThorname:xe}),e.jsx(ae,{inputAssets:[O],isOpened:G,onClose:()=>E(!1),onConfirm:()=>{J(),E(!1)},children:n?e.jsxs(u,{col:!0,children:[e.jsx(A,{label:"THUNDERName",value:m}),e.jsx(A,{capitalizeLabel:!0,label:s("view.thorname.cost"),value:`${W(Math.max(0,y-10))} THUNDER`}),y>0&&e.jsx(A,{capitalizeLabel:!0,label:s("view.thorname.duration"),value:`${y} ${y>1?s("view.thorname.years"):s("view.thorname.year")}`})]}):e.jsxs(u,{col:!0,children:[e.jsx(A,{label:"THUNDERName",value:m}),e.jsx(A,{capitalizeLabel:!0,label:s("view.thorname.cost"),value:`${W(y)} THUNDER`}),e.jsx(A,{capitalizeLabel:!0,label:s("view.thorname.duration"),value:`${y} ${y>1?s("view.thorname.years"):s("view.thorname.year")}`})]})}),e.jsx(ae,{inputAssets:[O],isOpened:_,onClose:()=>$(!1),onConfirm:()=>{j(l||"",w),$(!1)},children:e.jsxs(u,{col:!0,children:[e.jsx(A,{label:"THUNDERName",value:m}),e.jsx(A,{capitalizeLabel:!0,label:s("common.transferAddress"),value:H(w,6,8)})]})})]})},oa=Qe;export{oa as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["G7qcxkrX.js","assets/index-BDcs8OaA.js","assets/index-PWKo4Vxk.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
