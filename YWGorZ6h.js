import{r as l,bG as J,t as s,e as I,j as e,B as i,T as N,ac as B,U as P,m as Q,aU as X,bH as Z,x as ee,bI as se,bJ as te,k as M,M as O,bK as ie,b as ae,be as ne,o as L,h as T,G as re,d as w,bL as D,bM as le,bN as oe,g as F,O as ce,bx as de,L as ue,K as me,v as xe,bp as he,bO as pe,bP as V,bw as ge,R as fe,bc as ye,q as be}from"./assets/index-BDcs8OaA.js";import{P as je}from"./gLsK49VX.js";import{R as ve}from"./BuU0vr-X.js";import{V as we}from"./bwNrJKc_.js";import{P as p}from"./S2rBcUGO.js";import{A as Ne}from"./HIXFujKF.js";import{I as Se}from"./nlzjmGkJ.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[t]="8beec497-6719-4fcd-a705-1a81e7819b8d",a._sentryDebugIdIdentifier="sentry-dbid-8beec497-6719-4fcd-a705-1a81e7819b8d")}catch{}})();const Ce=l.memo(({asset:a,lpName:t,assetShare:m,contentRef:x,lastAddedDate:n,maxHeightStyle:g,poolShare:f,runeShare:o,shareType:c,runeWithdrawn:h,assetWithdrawn:S,runePending:y,assetPending:v,pendingTicker:b})=>{const d=l.useCallback(q=>J(q,{toFixed:6}),[]),A=l.useMemo(()=>[...y!=="0"?[{label:s("views.liquidity.runePending"),value:d(y)}]:[],...v!=="0"?[{label:s("views.liquidity.assetPending"),value:d(v)}]:[],...[p.SYM,p.RUNE_ASYM].includes(c)?[{label:`${I.symbol} ${s("views.liquidity.share")}`,value:e.jsxs(i,{center:!0,className:"gap-2",children:[e.jsx(N,{children:`${o} ${I.symbol}`}),e.jsx(B,{asset:I,size:24})]})}]:[],...[p.SYM,p.ASSET_ASYM].includes(c)?[{label:`${a.ticker} ${s("views.liquidity.share")}`,value:e.jsxs(i,{center:!0,className:"gap-2",children:[e.jsx(N,{children:`${m} ${a.ticker}`}),e.jsx(B,{asset:a,size:24})]})}]:[],{label:s("views.liquidity.poolShare"),value:f},...h!=="0"?[{label:s("views.liquidity.runeWithdrawn"),value:d(h)}]:[],...S!=="0"?[{label:s("views.liquidity.assetWithdrawn"),value:d(S)}]:[],{label:s("views.liquidity.lastAdded"),value:n}],[y,d,v,c,o,a,m,f,h,S,n]);return e.jsxs(i,{col:!0,className:"overflow-hidden ease-in-out transition-all",ref:x,style:g,children:[!!b&&e.jsx(N,{className:"brightness-90",textStyle:"caption",variant:"yellow",children:s("pendingLiquidity.content",{asset:b})}),e.jsxs(i,{col:!0,className:"self-stretch pt-1 pb-2",children:[e.jsx(i,{alignCenter:!0,row:!0,justify:"between",children:e.jsx(N,{className:"px-1.5",textStyle:"caption",variant:"cyan",children:t})}),e.jsx(Se,{horizontalInset:!0,items:A,size:"sm"})]})]})}),Ie=({poolUnits:a,liquidityUnits:t})=>{const m=M.fromBigInt(BigInt(a),8);return M.fromBigInt(BigInt(t)).div(m).getValue("number")},qe=({dateLastAdded:a,shareType:t,withFooter:m,pool:x,poolUnits:n="0",sharedUnits:g,runePending:f,hardCapReached:o,assetPending:c,assetWithdrawn:h,runeWithdrawn:S,poolAssetDepth:y="0",poolRuneDepth:v="0"})=>{const b=P(),{isActive:d,contentRef:A,toggle:q,maxHeightStyle:E}=Q(),{isMdActive:R}=X(),r=l.useMemo(()=>Z(x),[x]),u=l.useMemo(()=>ee.fromStringSync(x),[x]),j=l.useMemo(()=>{if(Number(f)>0)return r;if(Number(c)>0)return I.ticker},[c,r,f]),$=l.useMemo(()=>`${(t===p.SYM?[I.ticker,r]:t===p.ASSET_ASYM?[r]:[I.ticker]).join(" + ")} LP`,[r,t]),{runeShare:H,assetShare:_,poolShare:Y}=l.useMemo(()=>{const C={liquidityUnits:g,poolUnits:n,runeDepth:v,assetDepth:y},k=parseInt(n)>0,U=k?se(C).getValue("string"):"0",W=k?te(C).getValue("string"):"0",G=t===p.SYM&&k?M.fromBigInt(BigInt(C.runeDepth),O.THUNDER).mul(C.liquidityUnits).div(n).getValue("string"):U,K=t===p.SYM&&k?M.fromBigInt(BigInt(C.assetDepth),O.THUNDER).mul(C.liquidityUnits).div(n).getValue("string"):W,z=k?Ie({liquidityUnits:g,poolUnits:n}):0;return{runeShare:new M(G).toSignificant(6),assetShare:new M(K).toSignificant(6),poolShare:z>1e-4?`${ie(z,5)}`:"~0%"}},[y,v,n,t,g]);return e.jsx(i,{col:!0,justifyCenter:!0,className:"self-stretch",children:e.jsxs(ae,{className:"!rounded-2xl p-2 !gap-1",type:j?"warn":"primary",children:[e.jsxs(i,{alignCenter:!0,className:"cursor-pointer",justify:"between",onClick:q,children:[e.jsxs(i,{center:!0,children:[j&&e.jsx(ne,{content:s("pendingLiquidity.pendingLiquidity"),children:e.jsx(L,{className:"mr-3",color:"yellow",name:"warn",size:24})}),e.jsx(i,{col:!0,children:e.jsx(Ne,{inline:!0,asset1:u,asset2:I,size:d&&R?40:32})}),e.jsx(N,{className:T("mx-1 md:mx-3 !transition-all",d?"text-body md:!text-subtitle1":"!text-body"),fontWeight:"semibold",children:$})]}),e.jsxs(i,{center:!0,className:"gap-2",children:[e.jsxs(i,{col:!0,align:"end",children:[e.jsx(N,{className:T("!transition-all",d?"!text-body":"!text-caption"),fontWeight:"normal",children:` ${s("views.liquidity.poolShare")}`}),e.jsx(N,{className:T("!transition-all",d?"!text-subtitle1":"!text-body"),fontWeight:"bold",children:Y})]}),e.jsx(L,{className:T("transform duration-300 ease",{"-rotate-180":d}),color:"secondary",name:"chevronDown"})]})]}),e.jsx(Ce,{asset:u,assetPending:c,assetShare:_,assetWithdrawn:h,contentRef:A,lastAddedDate:re.unix(Number(a)).format("YYYY-MM-DD"),lpName:$,maxHeightStyle:E,pendingTicker:j,poolShare:Y,runePending:f,runeShare:H,runeWithdrawn:S,shareType:t}),m&&e.jsxs(i,{justifyCenter:!0,className:"space-x-6 md:pr-0",children:[e.jsx(i,{className:"w-full",children:e.jsx(w,{stretch:!0,className:"px-8 md:px-12",disabled:o,onClick:()=>b(D(u)),rightIcon:o?e.jsx(L,{name:"infoCircle",size:20}):void 0,tooltip:o?s("views.liquidity.hardCapReachedTooltip"):void 0,tooltipClasses:"text-center mx-[-2px]",variant:o?"fancyError":"primary",children:j?s("views.liquidity.completeButton"):s("views.liquidity.addButton")})}),e.jsx(i,{className:"w-full",children:e.jsx(w,{stretch:!0,className:"px-8 md:px-12",onClick:()=>b(le(u)),variant:"secondary",children:s("common.withdraw")})})]})]})})},Me=({chain:a,data:t,hardCapReached:m})=>{const x=l.useCallback(({assetAddress:o,runeAddress:c})=>o&&c?p.SYM:o?p.ASSET_ASYM:c?p.RUNE_ASYM:p.SYM,[]),[n,g]=l.useMemo(()=>{const o=t?.find(({assetAddress:h})=>h)?.assetAddress,c=t?.find(({runeAddress:h})=>h)?.runeAddress;return[o,c]},[t]),f=l.useMemo(()=>`${oe()}}?${g?`${F.THUNDERChain.toLowerCase()}=${g}`:""}${n?`${a.toLowerCase()}=${n}`:""}`,[n,a,g]);return e.jsxs(i,{col:!0,className:"gap-1",children:[e.jsx(ce,{className:"!mx-1.5 pl-1.5",label:e.jsx(N,{children:de(a,!0)}),size:"sm",value:e.jsx(i,{className:"gap-x-2 mb-1",children:e.jsx(ue,{external:!0,to:f,children:e.jsx(w,{className:"px-2.5",leftIcon:e.jsx(L,{name:"chart",size:16}),tooltip:s("common.viewOnThoryield"),variant:"borderlessTint"})})})}),t.map(o=>l.createElement(qe,{...o,withFooter:!0,hardCapReached:m,key:o.pool,shareType:x(o)}))]})},Ye=()=>{const a=P(),{setIsConnectModalOpen:t}=me(),{walletAddresses:m,isWalletLoading:x}=xe(),n=he(),[g,f]=l.useState(!0),[o,c]=l.useState(!1),[h,S]=l.useState({}),[y,v]=l.useState({}),b=l.useMemo(()=>Object.values(y).length>0?Object.values(y):m,[m,y]),{data:d,isFetching:A,refetch:q}=pe(b,{skip:!b.length||x}),E=l.useMemo(()=>d?.some(({assetPending:r,runePending:u})=>parseInt(r)>0||parseInt(u)>0),[d]),R=l.useMemo(()=>d?.reduce((r,u)=>{const[j]=u.pool.split(".");return r[j]=[...r[j]||[],u],r},{})??{},[d]);return e.jsxs(je,{description:s("views.liquidity.description"),header:e.jsx(we,{actionsComponent:e.jsxs(e.Fragment,{children:[V&&e.jsx(w,{className:"mr-4",onClick:()=>c(!0),size:"sm",variant:"fancy",children:"Test Modal"}),e.jsx(ve,{loading:x||A,onLoad:q})]}),title:s("common.liquidityPosition")}),keywords:"LP, Liquidity provider, THUNDERSwap, THUNDERChain, DEFI, DEX",title:s("views.liquidity.title"),children:[e.jsxs(i,{col:!0,className:"gap-3 self-stretch",children:[E&&g&&e.jsx(ge,{className:"mt-0 mb-4",content:s("pendingLiquidity.pendingInfoGeneral"),onClose:()=>f(!1),title:s("pendingLiquidity.pendingInfoTitle"),type:"warn"}),e.jsx(i,{className:"w-full gap-x-8",justify:"between",children:b.length>0?e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"w-full",children:e.jsx(w,{stretch:!0,disabled:n,onClick:()=>a(D()),rightIcon:n?e.jsx(L,{name:"infoCircle",size:20}):void 0,size:"lg",tooltip:n?s("views.liquidity.hardCapReachedTooltip"):void 0,tooltipClasses:"text-center mx-[-2px]",variant:n?"fancyError":"primary",children:s("common.deposit")})}),e.jsx(i,{className:"w-full",children:e.jsx(w,{stretch:!0,onClick:()=>a(fe.CreateLiquidity),size:"lg",children:s("common.create")})})]}):e.jsx(w,{stretch:!0,onClick:()=>t(!0),size:"lg",variant:"fancy",children:s("common.connectWallet")})}),Object.entries(R).map(([r,u])=>e.jsx(Me,{chain:r,data:u,hardCapReached:n},r))]}),V&&e.jsx(ye,{isOpened:o,onClose:()=>c(!1),title:"Type in address to show it's LP positions",children:e.jsxs(i,{col:!0,className:"gap-2",flex:1,children:[Object.keys(F).map(r=>e.jsx(be,{stretch:!0,border:"rounded",className:"!text-md p-1.5 flex-1 border",containerClassName:"bg-light-gray-light dark:bg-dark-gray-light !bg-opacity-80",onChange:u=>S(j=>({...j,[r]:u.target.value})),placeholder:r,value:h[r]??""},r)),e.jsx(w,{stretch:!0,className:"mt-4",onClick:()=>{v(h),c(!1)},size:"lg",variant:"fancy",children:"Save"})]})})]})};export{Ye as default};
