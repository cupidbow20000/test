import{r as s,j as v,B as R,h as te,o as Ne,t as o,e as w,bo as ut,T as ne,v as de,bO as ct,ac as lt,I as W,$ as dt,u as mt,K as gt,bq as ft,br as ht,ae as bt,k as d,bK as At,bs as Ce,g as j,bj as vt,aX as ie,aY as oe,aZ as se,_ as ue,b0 as ce,b1 as K,a1 as Pe,s as Ee,M as St,U as pt,a4 as wt,bL as xt,x as Le}from"./assets/index-BDcs8OaA.js";import{A as Re}from"./u_4jEEiW.js";import{u as It}from"./VlgDKYov.js";import{L as c}from"./S2rBcUGO.js";import{u as Mt}from"./FUKZW4Fx.js";import{g as Ct}from"./pLeNDp8K.js";import{u as Pt}from"./aF5kppaH.js";import{g as Et}from"./g03_-ZTT.js";import{u as Lt}from"./0YkWVzPW.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},r=new Error().stack;r&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[r]="b154207e-5319-4a30-a36b-49fb824808d0",n._sentryDebugIdIdentifier="sentry-dbid-b154207e-5319-4a30-a36b-49fb824808d0")}catch{}})();const zt=s.memo(({poolAsset:n,runeAsset:r,poolAssetList:t,onAssetAmountChange:b,onRuneAmountChange:e,onPoolChange:a,liquidityType:u,isAssetPending:g,isRunePending:f})=>{const{assetInputProps:l,assets:h}=It(t);return v.jsxs(R,{col:!0,className:"relative self-stretch w-full",children:[v.jsx(R,{className:te("absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2","p-1 md:p-2 rounded-xl md:rounded-[18px]","border-10 border-solid bg-blue dark:border-dark-border-primary border-transparent","opacity-100 scale-100 transition-all",{"!scale-0 !opacity-0":u!==c.SYMMETRICAL}),children:v.jsx(Ne,{className:te("w-7 h-7"),color:"white",name:"plus"})}),v.jsx(R,{className:te("overflow-hidden h-[111px] transition-all",{"!h-[0px]":u===c.THUNDER}),children:v.jsx(Re,{...l,assets:h,className:"!mb-1 flex-1",disabled:g,maxButtonLabel:f?o("pendingLiquidity.complete"):"",onAssetChange:a,onValueChange:b,selectedAsset:n,warning:g?o("pendingLiquidity.content",{asset:w.ticker}):""})}),v.jsx(R,{className:te("overflow-hidden transition-all",{"!h-[0px]":u===c.ASSET,"h-[111px] ":u!==c.THUNDER,"h-[140px] md:h-[111px]":u===c.THUNDER}),children:v.jsx(Re,{singleAsset:!0,assets:t,className:"!mb-1 flex-1",disabled:f,maxButtonLabel:g?o("pendingLiquidity.complete"):"",onAssetChange:a,onValueChange:e,poolAsset:n,selectedAsset:r,showSecondaryChainSelector:u===c.THUNDER,warning:f?o("pendingLiquidity.content",{asset:n.asset.ticker}):""})})]})}),Rt="gap-2 border-0 border-r border-dotted border-light-typo-gray dark:border-dark-typo-gray",Xt=({poolTicker:n,runeTicker:r,poolShare:t,slippage:b,fee:e,rate:a})=>{const u=[{label:`${r} ${o("common.per")} ${n}`,value:a||"N/A"},{label:o("views.wallet.slip"),value:b||"N/A"},{label:o("common.fee"),value:e||"N/A"},{label:o("views.addLiquidity.shareOfPool"),value:t||"N/A"}];return v.jsx(ut,{className:"self-stretch !mt-0 !bg-light-bg-primary dark:!bg-dark-gray-light !rounded-2xl flex-col",shadow:!1,title:v.jsxs(R,{row:!0,className:"gap-x-2",children:[v.jsx(Ne,{color:"secondary",name:"infoCircle",size:16}),v.jsx(ne,{fontWeight:"normal",textStyle:"caption",variant:"primary",children:o("views.addLiquidity.pricesAndPoolShare")})]}),children:v.jsx(R,{className:"w-full",children:u.map(({label:g,value:f},l)=>{const h=l===0,C=l===u.length-1;return v.jsxs(R,{col:!0,alignCenter:!(h||C),className:C?"text-right":Rt,flex:1,justify:"between",children:[v.jsx(ne,{fontWeight:"semibold",textStyle:"caption",variant:"secondary",children:g}),v.jsx(ne,{className:"text-base md:text-h4",textStyle:"caption",children:f})]},g)})})})},Zt=n=>{const[r,t]=s.useState(n||c.SYMMETRICAL);return{liquidityType:r,setLiquidityType:t}},Vt=({testAddresses:n}={})=>{const{walletAddresses:r,isWalletLoading:t}=de(),b=s.useMemo(()=>{const f=Object.values(n||{});return f.length>0?f:r},[r,n]),{data:e,isFetching:a,isLoading:u,refetch:g}=ct(b,{skip:!b.length||t});return{data:e,refetch:g,isLoading:a||u}},Nt=({assetString:n,liquidityType:r})=>{const{walletAddresses:t}=de(),{data:b,refetch:e,isLoading:a}=Vt(),u=s.useMemo(()=>b?.find(({pool:l,runeAddress:h,assetAddress:C})=>l.toLowerCase()!==n.toLowerCase()?!1:r===c.SYMMETRICAL?t.includes(h)&&t.includes(C):!0)||{},[n,b,t,r]),g=s.useMemo(()=>parseInt(u?.runePending||"0")>0,[u?.runePending]),f=s.useMemo(()=>parseInt(u?.assetPending||"0")>0,[u?.assetPending]);return{lpMemberData:u,isRunePending:g,isAssetPending:f,refetch:e,isLoading:a}},_t=({assets:n,fees:r,totalFee:t,poolShare:b,slippage:e,estimatedTime:a})=>{const u=n.map(l=>({label:`${o("views.liquidity.depositAmount")} ${l.asset.symbol}`,value:v.jsxs(R,{alignCenter:!0,justify:"between",children:[v.jsx(ne,{className:"mx-2",fontWeight:"semibold",children:l.value}),v.jsx(lt,{asset:l.asset,size:24})]})})),g=r.map(l=>({label:`${l.chain==="THUNDER"?"THUNDERChain":l.chain} ${o("common.fee")}`,value:v.jsx(W,{tooltip:o("views.liquidity.chainFeeTooltip",{chain:l.chain==="THUNDER"?"THUNDERChain":l.chain}),value:l.fee})}));return[...u,{label:o("views.wallet.slip"),value:v.jsx(W,{tooltip:o("views.wallet.slippageTooltip"),value:e||"N/A"})},{label:o("views.liquidity.poolShareEstimated"),value:v.jsx(W,{tooltip:o("views.liquidity.poolShareTooltip"),value:b})},...g,{label:o("views.wallet.totalFee"),value:v.jsx(W,{tooltip:o("views.wallet.totalFeeTooltip"),value:t||"N/A"})},{label:o("views.wallet.estimatedTime"),value:v.jsx(W,{tooltip:o("views.wallet.estimatedTimeTooltip"),value:a})}]},Ve=n=>d.fromBigInt(BigInt(n),St.THUNDER),Tt=({depth:n,poolUnits:r,liquidityUnits:t})=>new d(n).mul(t).div(r).getValue("string"),jt=({runeAmount:n,assetAmount:r,runeDepth:t,assetDepth:b})=>{if(n==="0"||r==="0"||t==="0"||b==="0")return 0;const e=Ve(t),a=Ve(b),u=new d({value:r,decimal:8}).mul(10**8),g=new d(n).mul(10**8),f=u.mul(e).sub(a.mul(g)),l=a.mul(g).add(e.mul(a));return Math.abs(f.div(l).getBaseValue("number"))},yt=({runeDepth:n,assetDepth:r,liquidityUnits:t,runeAmount:b,assetAmount:e})=>{if(b==="0"&&e==="0")return 0;const a=new d({value:n,decimal:8}),u=new d({value:r,decimal:8}),g=new d({value:t,decimal:8}),f=new d(b).mul(10**8),l=new d(e).mul(10**8),h=f.mul(u),C=l.mul(a),O=f.mul(l),z=a.mul(u),X=g.mul(h.add(C.add(O.mul(2)))),E=h.add(C.add(z.mul(2))),U=X.div(E||1);return U.gt(0)?U.div(g||1).getValue("number"):0},le=({assetAmount:n,runeAmount:r,runePriceInAsset:t,assetPriceInRune:b,minAssetAmount:e,minRuneAmount:a})=>{const u=r.mul(t);if(u.gt(n)){const l=n.lte(e)?e:n,h=r.lte(a)?a:r,C=Math.min(l.set(l.getValue("number")/t).getValue("number"),r.getValue("number")),O=Math.min(h.set(h.getValue("number")/b).getValue("number"),n.getValue("number"));return{maxSymAssetAmount:l.set(O),maxSymRuneAmount:n.set(C)}}const g=u.lte(e)?e:u,f=r.lte(a)?a:r;return{maxSymAssetAmount:g,maxSymRuneAmount:f}},Bt={assetAddress:"",contract:"",symmetric:!1,lpProgressModal:!1,poolAddress:"",poolAssetValue:void 0,runeAddress:"",runeAssetValue:void 0},kt=(n,{type:r,payload:t})=>{switch(r){case"setLpProgressModal":return{...n,lpProgressModal:t};case"setContract":return{...n,contract:t};case"setLPProgressState":return{...n,...t,lpProgressModal:!0};default:return n}},Qt=({onAddLiquidity:n,skipWalletCheck:r,liquidityType:t,setLiquidityType:b,poolAsset:e,poolData:a,depositAssetsBalance:u,wallet:g})=>{const{hasWallet:f,getWallet:l}=de(),h=dt(),{expertMode:C}=mt(),{setIsConnectModalOpen:O}=gt(),{isChainPauseLPAction:z}=ft(),{getChainDepositLPPaused:X}=ht(),{data:E}=bt([w,e]),[U,Z]=s.useReducer(kt,Bt),{isWalletAssetConnected:me,runeBalance:ge,maxRuneBalance:F,poolAssetBalance:fe,maxPoolAssetBalance:y}=u,D=s.useCallback(i=>l(i)||g?.[i],[l,g]),he=s.useMemo(()=>z(e.chain)||X(e.chain),[z,e.chain,X]),{lpMemberData:A,isAssetPending:x,isRunePending:M}=Nt({assetString:e.toString(),liquidityType:t}),L=s.useMemo(()=>t===c.SYMMETRICAL&&!C,[t,C]),[S,B]=s.useState(new d({value:0,decimal:8})),[p,k]=s.useState(new d({value:0,decimal:8})),[_e,Q]=s.useState(!1),[Te,ae]=s.useState(!1),[je,ye]=s.useState(!0),{feeInUSD:be,inputFee:Ae,outputFee:Be}=Pt({inputAsset:e,outputAsset:w}),G=s.useMemo(()=>({runeAmount:p.getValue("string"),assetAmount:S.getValue("string"),runeDepth:a?.runeDepth??"0",assetDepth:a?.assetDepth??"0",liquidityUnits:a?.liquidityUnits??"0",poolUnits:a?.units??"0"}),[S,a?.assetDepth,a?.liquidityUnits,a?.runeDepth,a?.units,p]),V=parseInt(a?.assetDepth||"0")/parseInt(a?.runeDepth||"0"),N=parseInt(a?.runeDepth||"0")/parseInt(a?.assetDepth||"0"),ve=s.useMemo(()=>jt(G).toFixed(2),[G]),Se=s.useMemo(()=>At(yt(G)),[G]),H=s.useMemo(()=>{const i=!!D(e.chain),m=!!D(w.chain);return t===c.ASSET?i:(t===c.THUNDER||i)&&m},[D,e.chain,t]),pe=s.useCallback(async i=>{const m=await Et()||[],{router:I,halted:P}=m.find(re=>re.chain===i)||{};if(P&&!I)throw new Error("Trading & LP is temporarily halted, please try again later.");Z({type:"setContract",payload:I||""})},[]);s.useEffect(()=>{pe(e.chain)},[pe,e.chain]);const{isApproved:we,isLoading:ke}=Lt({assetValue:e.set(S.getValue("string")),contract:U.contract,force:!0}),J=s.useMemo(()=>e.toString(),[e]),xe=s.useMemo(()=>{const i=E[J]?.price_usd||0,m=x&&d.fromBigInt(BigInt(A?.assetPending||"0")).getValue("number")||S.getValue("number");return i*m},[E,J,x,A?.assetPending,S]),_=s.useMemo(()=>Ce(j.THUNDERChain),[]),T=s.useMemo(()=>vt(e)?Ce(e.chain):new d({value:0,decimal:8}),[e]),{maxSymAssetAmount:Ie,maxSymRuneAmount:Me}=s.useMemo(()=>a?le(x&&A?{runeAmount:F,assetAmount:d.fromBigInt(BigInt(A.assetPending),8),runePriceInAsset:V,assetPriceInRune:N,minAssetAmount:T,minRuneAmount:_}:y&&M&&A?{runeAmount:d.fromBigInt(BigInt(A.runePending),8),assetAmount:y,runePriceInAsset:V,assetPriceInRune:N,minAssetAmount:T,minRuneAmount:_}:{runeAmount:F||d.fromBigInt(BigInt(0),8),assetAmount:y||d.fromBigInt(BigInt(0),8),runePriceInAsset:V,assetPriceInRune:N,minAssetAmount:T,minRuneAmount:_}):{maxSymAssetAmount:new d({value:0,decimal:8}),maxSymRuneAmount:new d({value:0,decimal:8})},[a,x,A,M,F,y,V,N,T,_]),Oe=s.useCallback(i=>{i===c.ASSET?k(new d({value:0,decimal:8})):i===c.THUNDER&&B(new d({value:0,decimal:8})),b(i)},[b]),Ue=s.useCallback(i=>{if(!a){B(i);return}const m=L?Ie:y;m&&i.gt(m)&&!r?(B(new d({value:m.getValue("string"),decimal:8})),L&&k(new d({value:m.mul(N).getValue("string"),decimal:8}))):(B(i),L&&k(new d({value:i.mul(N).getValue("string"),decimal:8})))},[a,L,Ie,y,r,N]),Fe=s.useCallback(i=>{if(!a){k(i);return}const m=L?Me:F;m&&i.gt(m)&&!r?(k(new d({value:m.getValue("string"),decimal:8})),L&&B(new d({value:m.mul(V).getValue("string"),decimal:8}))):(k(i),L&&B(i.mul(V)))},[a,L,Me,F,r,V]),De=s.useCallback(async()=>{if(Q(!1),n&&e&&t!==c.ASSET){n({poolAsset:e,runeAmount:w.set(p.getValue("string"))});return}if(f&&a){const i=t!==c.ASSET?w.set(p.getValue("string")):void 0,m=t!==c.THUNDER?e.set(S.getValue("string")):void 0,I=ie(),P=ie();!M&&i&&h(oe({id:I,label:o("txManager.addAmountAsset",{asset:w.ticker,amount:p.toSignificant(6)}),type:se.TC_LP_ADD,inChain:j.THUNDERChain})),!x&&m&&h(oe({id:P,label:o("txManager.addAmountAsset",{asset:e.ticker,amount:S.toSignificant(6)}),type:se.TC_LP_ADD,inChain:e.chain}));const re=M||x||t===c.SYMMETRICAL,at=M||x||t===c.SYMMETRICAL?{runeAddr:A?.runeAddress,assetAddr:A?.assetAddress}:{},rt=t===c.SYMMETRICAL?"sym":t===c.ASSET?"asset":"rune",it={runeAssetValue:w.set(p.getValue("string")),assetValue:e.set(S.getValue("string")),isPendingSymmAsset:re,mode:rt,poolIdentifier:"",...at},{addLiquidity:ot}=await(await ue(()=>import("./G7qcxkrX.js"),__vite__mapDeps([0,1,2]))).getSwapKitClient();try{const{runeTx:Y,assetTx:ee}=await ot(it);h(Y!=="failed"?ce({id:I,txid:Y}):K({id:I,status:"error"})),h(ee!=="failed"?ce({id:P,txid:ee}):K({id:P,status:"error"}))}catch(Y){const ee=Y?.data?.originalError||Y.message;h(K({id:I,status:"error"})),h(K({id:P,status:"error"})),Pe(o("notification.submitFail"),ee)}}},[n,e,t,f,a,p,S,M,x,A?.runeAddress,A?.assetAddress,h]),He=s.useCallback(async()=>{if(Q(!1),f&&a){const i=t!==c.ASSET&&!M?w.set(p.getValue("string")):void 0,m=t!==c.THUNDER&&!x?e.set(S.getValue("string")):void 0,{getAddress:I}=await(await ue(()=>import("./G7qcxkrX.js"),__vite__mapDeps([0,1,2]))).getSwapKitClient();Z({type:"setLPProgressState",payload:{runeAssetValue:i,poolAssetValue:m,symmetric:t===c.SYMMETRICAL,poolAddress:e.toString(),runeAddress:I(j.THUNDERChain),assetAddress:I(e.chain)}})}},[f,a,t,x,p,M,e,S]),$e=s.useCallback(async()=>{if(ae(!1),me(e)){const i=ie(),m=e.chain===j.Ethereum?se.ETH_APPROVAL:se.AVAX_APPROVAL;h(oe({id:i,type:m,label:`${o("txManager.approve")} ${e.ticker}`,inChain:e.chain}));const{approveAssetValue:I}=await(await ue(()=>import("./G7qcxkrX.js"),__vite__mapDeps([0,1,2]))).getSwapKitClient();try{const P=await I(e);typeof P=="string"&&h(ce({id:i,txid:P}))}catch(P){console.error(P),h(K({id:i,status:"error"})),Pe(o("notification.approveFailed"))}}},[h,e,me]),Ye=s.useCallback(()=>{if(!H&&!r)return Ee(o("notification.walletNotFound"),o("notification.connectWallet"));Q(!0)},[H,r]),We=s.useCallback(()=>{f?ae(!0):Ee(o("notification.walletNotFound"),o("notification.connectWallet"))},[f]),Ke=s.useMemo(()=>t===c.THUNDER?[w]:t===c.ASSET?[e]:[e,w],[t,e]),ze=s.useMemo(()=>x||t===c.THUNDER?[{asset:w,value:p.toSignificant(6)}]:M||t===c.ASSET?[{asset:e,value:S.toSignificant(6)}]:[{asset:w,value:p.toSignificant(6)},{asset:e,value:S.toSignificant(6)}],[x,t,M,p,e,S]),q=s.useMemo(()=>{if(he)return{valid:!1,msg:o("notification.notAvailableDeposit")};if(t===c.SYMMETRICAL){if(!p.gte(_)||!S.gte(T))return{valid:!1,msg:o("notification.invalidAmount")};if(A&&(Number(A.assetPending)||Number(A.runePending))&&Number(A.runeAdded)&&!Number(A.assetAdded))return{valid:!1,msg:o("notification.alreadyHaveRune")}}return t===c.ASSET&&!S.gte(T)?{valid:!1,msg:o("notification.insufficientAmount")}:t===c.THUNDER&&!p.gte(_)?{valid:!1,msg:o("notification.insufficientAmount")}:{valid:!0}},[A,he,t,p,S,_,T]),$=s.useMemo(()=>!!D(e.chain)&&we===!1&&t!==c.THUNDER,[D,we,t,e.chain]),Xe=s.useMemo(()=>({asset:e,balance:fe,usdPrice:xe,value:x&&A?d.fromBigInt(BigInt(A.assetPending),e.decimal):S}),[e,fe,xe,x,A,S]),Ze=s.useMemo(()=>{const i=M&&A?d.fromBigInt(BigInt(A.runePending),8):p,m=E[w.toString()]?.price_usd||0;return{asset:w,balance:ge,usdPrice:m*i.getValue("number"),value:i}},[M,A,p,ge,E]),Qe=s.useMemo(()=>`Add ${e.ticker} Liquidity`,[e]),Ge=s.useMemo(()=>q.valid?$?"Add":"Add Liquidity":q.msg,[q,$]),Je=s.useMemo(()=>{const i=t===c.THUNDER;return Ct({amount:i?p:S,chain:i?j.THUNDERChain:e.chain})},[t,S,p,e]),qe=_t({assets:ze,poolShare:Se,slippage:ve||"N/A",estimatedTime:Je,totalFee:be,fees:[{chain:e.chain,fee:Ae.toSignificant()},{chain:j.THUNDERChain,fee:Be.toSignificant()}]}),et=Mt({assetName:e.ticker,assetValue:S.toSignificant(6),fee:Ae.toSignificant()}),tt=s.useMemo(()=>H&&!$,[H,$]),st=s.useMemo(()=>{const i=E[w.toString()]?.price_usd||0,m=E[J]?.price_usd||.001,I=i/m;return Number.isNaN(I)?0:I},[J,E]),nt=s.useCallback(i=>Z({type:"setLpProgressModal",payload:i}),[Z]);return{...U,addLiquiditySlip:ve,approveConfirmInfo:et,asymmTipVisible:je,btnLabel:Ge,confirmInfo:qe,depositAssets:Ke,feeInUSD:be,getEstimatedPoolShareForPoolDepth:Tt,handleAddLiquidity:Ye,handleApprove:We,handleChangeAssetAmount:Ue,handleChangeRuneAmount:Fe,handleConfirmAdd:De,handleConfirmProgressModal:He,handleConfirmApprove:$e,handleSelectLiquidityType:Oe,isApproveRequired:$,isAssetApproveLoading:ke,isAssetPending:x,isDepositAvailable:tt,isRunePending:M,isValidDeposit:q,isWalletConnected:H,lpMemberData:A,poolAssetInput:Xe,poolShareEst:Se,rate:st,runeAssetInput:Ze,setAsymmTipVisible:ye,setIsConnectModalOpen:O,setLpProgressModal:nt,setVisibleApproveModal:ae,setVisibleConfirmModal:Q,title:Qe,visibleApproveModal:Te,visibleConfirmModal:_e}},Gt=({assetRouteGetter:n=xt}={})=>{const r=pt(),{assetParam:t}=wt(),[b,e]=s.useState();s.useEffect(()=>{(async()=>{const g=t?Le.fromStringSync(t):Le.fromChainOrSignature(j.Bitcoin);e(g)})()},[t]);const a=s.useCallback(u=>{r(n(u))},[n,r]);return{poolAsset:b,assetParam:t,handleSelectPoolAsset:a}};export{zt as A,Xt as P,Gt as a,Qt as b,Zt as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["G7qcxkrX.js","assets/index-BDcs8OaA.js","assets/index-PWKo4Vxk.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
